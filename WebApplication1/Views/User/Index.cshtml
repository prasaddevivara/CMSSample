@model IEnumerable<WebApplication1.Models.UserViewModel>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Users</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.UserId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UserName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Password)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FirstName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LastName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Email)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Mobile)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.UserId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UserName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Password)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LastName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Mobile)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", "User", new { id = item.UserId }, null) |            
            <a onclick="DeleteUser(@item.UserId)" href="">Delete</a>
        </td>
    </tr>
}

</table>

<script type="text/javascript">

    function DeleteUser(id) {         
        if (confirm("Are you sure to delete User?")) {
            $.ajax({
                type: "POST", 
                url: 'https://localhost:44362/User/Delete',  
                async: false,                                            
                data: JSON.stringify({ 'Id': id }),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    if (data.status == "Success") {
                        alert(data.message);
                        return true;
                    } else {
                        alert("Error occurs on the Database level!");
                        return false;
                    }
                },
                error: function () {
                    alert("An error has occured!!!");
                    return false;
                }
            });
        }
        else {
            return false;
        }
            
    }
</script>